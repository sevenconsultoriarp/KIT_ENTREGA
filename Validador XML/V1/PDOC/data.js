
		let dataProject = {"projectName":"","tree":{"name":"raiz","files":[],"paths":[{"name":"PE","files":[{"file":"MT100TOK_pe.prw","uniqueName":"/PE/MT100TOK_pe.prw"},{"file":"MT103FIM_pe.prw","uniqueName":"/PE/MT103FIM_pe.prw"},{"file":"MT116AGR_pe.prw","uniqueName":"/PE/MT116AGR_pe.prw"},{"file":"MT116TOK_pe.prw","uniqueName":"/PE/MT116TOK_pe.prw"},{"file":"MT140SAI_pe.prw","uniqueName":"/PE/MT140SAI_pe.prw"},{"file":"MT140TOK_pe.prw","uniqueName":"/PE/MT140TOK_pe.prw"},{"file":"MTA094RO_pe.prw","uniqueName":"/PE/MTA094RO_pe.prw"},{"file":"MTA103MNU_pe.prw","uniqueName":"/PE/MTA103MNU_pe.prw"}],"paths":[]},{"name":"Rotinas PRW","files":[{"file":"F7VDANFPVALXML.prw","uniqueName":"/Rotinas PRW/F7VDANFPVALXML.prw"},{"file":"F7VDANFRVALXML.prw","uniqueName":"/Rotinas PRW/F7VDANFRVALXML.prw"},{"file":"F7VXML01.prw","uniqueName":"/Rotinas PRW/F7VXML01.prw"},{"file":"F7VXML02.prw","uniqueName":"/Rotinas PRW/F7VXML02.prw"},{"file":"F7VXML03.prw","uniqueName":"/Rotinas PRW/F7VXML03.prw"}],"paths":[]},{"name":"WebServiceTOTVSIP","files":[{"file":"WSIPServicos.prw","uniqueName":"/WebServiceTOTVSIP/WSIPServicos.prw"}],"paths":[]},{"name":"Classes","files":[{"file":"Class7VValidadorXML.tlpp","uniqueName":"/Classes/Class7VValidadorXML.tlpp"}],"paths":[]},{"name":"Rotinas TLPP","files":[{"file":"InstallValidadorXML.tlpp","uniqueName":"/Rotinas TLPP/InstallValidadorXML.tlpp"},{"file":"PEValidadorXML.tlpp","uniqueName":"/Rotinas TLPP/PEValidadorXML.tlpp"}],"paths":[]}]},"files":[{"fileName":"/PE/MT100TOK_pe.prw","functionList":[{"functionName":"MT100TOK","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada na função A103Tudok() para validação do inclusão da pré-nota/classificação do documento de Entrada\r<br>Esse ponto de entrada pertence ao MATA103X (funções de validação e controle de interface do documento de entrada).","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\tIf (ExistBlock(\"MT100TOK\"))\r<br>\t\tlPE := ExecBlock(\"MT100TOK\",.F.,.F.,{lRet})\r<br>\t\tIf ValType(lPE) = \"L\"\r<br>\t\t\tIf ! lPE\r<br>\t\t\t\tlRet := .F. // Corrigido p/ nao alterar o lRet, se .F., novamente p/ .T.\r<br>\t\t\tEndIf\r<br>\t\tEndIf\r<br>\tEndIf  \r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MT103FIM_pe.prw","functionList":[{"functionName":"MT103FIM","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada na operação após a gravação da Nota Fiscal de Entrada","example":[],"history":[],"link":[],"param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MT116AGR_pe.prw","functionList":[{"functionName":"MT116AGR","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada após gravação da NF de Conhecimento de Frete","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\tBegin Transaction\r<br>\t\ta103Grava(l116Exclui,lGeraLanc,lDigita,lAglutina,aHeadSE2,aColsSE2,aHeadSEV,aColsSEV,@nRecSF1,aRecSD1,aRecSE2,aRecSF3,aRecSC5,aHeadSDE,aColsSDE,aRecSDE,.T.,.F.,@aRecSF1Ori,aRatVei,aRatFro,Nil,Nil,Nil,Nil,Nil,Nil,Nil,nIndexSE2,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,Nil,cRecIss)\t\t\t\t\r<br>\t\tA116Grava(l116Exclui,nRecSF1,aRecSF1Ori,aRecSF8,aAmarrAFN)\r<br>\tEnd Transaction        \r<br>\t//Apaga o arquivo da Indregua\r<br>\t#IFNDEF TOP\t\t\t\t\r<br>\t\tRetIndex( \"SE2\" )  \r<br>\t\tFErase( cIndex+OrdBagExt() ) \r<br>\t#ENDIF\t\t\r<br>\tIf !InTransact()\r<br>\t\tSF1->(dbSetOrder(1))\r<br>\t\tEval(bFiltraBrw)\t\t\t\r<br>\tEndif\t\r<br>\tIf ExistBlock(\"MT116AGR\")\r<br>\t\tExecBlock(\"MT116AGR\",.F.,.F.)\r<br>\tEndIf\r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MT116TOK_pe.prw","functionList":[{"functionName":"MT116TOK","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada na Validação Tudo OK da Rotina de Inclusão de NF de Conhecimento de Transporte","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\t//Ponto de Entrada Padrao\r<br>\tIf lRet .And. (ExistBlock(\"MT116TOK\"))\r<br>\t\tlRet := ExecBlock(\"MT116TOK\",.F.,.F.)\r<br>\t\tIf ValType(lRet) <> \"L\"\r<br>\t\t\tlRet := .T.\r<br>\t\tEndIf\r<br>\tEndIf\r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MT140SAI_pe.prw","functionList":[{"functionName":"MT140SAI","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada disparado antes do retorno da rotina ao browse","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\t//O ponto de entrada e disparado apos o RestArea pois pode ser utilizado para posicionar o Browse\r<br>\tIf ExistBlock( \"MT140SAI\" )\r<br>\t\tExecBlock( \"MT140SAI\", .F., .F., { aRotina[ nOpcx, 4 ], cNFiscal, cSerie, cA100For, cLoja, cTipo, nOpcA } )\r<br>\tEndIf\r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MT140TOK_pe.prw","functionList":[{"functionName":"MT140TOK","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada na função A140Tudok() para validação do inclusão da pré-nota do Documento de Entrada","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\t//Chamada do Ponto de entrada para validacao da TudoOk\r<br>\tIf lRetorno .And. ExistBlock(\"MT140TOK\")\r<br>\t\tlRetorno := ExecBlock(\"MT140TOK\",.F.,.F.,{lRetorno})\r<br>\tEndIf\r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/PE/MTA094RO_pe.prw","functionList":[{"functionName":"MTA094RO","author":"Carlos Eduardo Niemeyer Rodrigues","database":"MSSQL,Oracle<br>@obs<br>\tIf ExistBlock(\"MTA094RO\")<br>\t\tIf ValType(aAcoes := ExecBlock( \"MTA094RO\", .F., .F., {aRotina}) ) == \"A\"<br>\t\t\taRotina:= aAcoes<br>\t\tEndIf<br>\tEndIf","description":"Ponto de Entrada na rotina de Liberação de Documentos","example":[],"history":[],"link":[],"param":[],"return":[],"see":"MATA094","since":"16/02/2021","type":"function","version":"P11,P12"}]},{"fileName":"/PE/MTA103MNU_pe.prw","functionList":[{"functionName":"MTA103MNU","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de entrada para incluir Itens no Menu da Rotina de Documento de Entrada","example":[],"history":[],"link":[],"obs":"\tContexto:\r<br>\t//Ponto de entrada utilizado para inserir novas opcoes no array aRotina\r<br>\tIf ExistBlock(\"MTA103MNU\")\r<br>\t\tExecBlock(\"MTA103MNU\",.F.,.F.)\r<br>\tEndIf\r","param":[],"return":[],"see":"Validador de XML SEVEN - produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/Rotinas PRW/F7VDANFPVALXML.prw","functionList":[{"functionName":"F7VDANFPVALXML","author":"Eduardo Riera\r","description":"Rotina de Impressão do DANFE - Formato Paisagem","example":[],"history":[{"date":"29/01/2021","username":"Carlos Eduardo Niemeyer Rodrigues","description":"Melhorias para o Validador de XML"}],"link":[],"param":[],"return":[],"since":"16/11/2006\r","type":"function\r"},{"functionName":"RetTamCol","author":"Marcos Taranta\r","description":"Retorna um array do mesmo tamanho do array de entrada, contendo as\r<br>medidas dos maiores textos para cálculo de colunas.","example":[],"history":[],"link":[],"param":[{"name":"aCabec     Array contendo as strings de cabeçalho das colunas","type":"","description":"","obrigatory":""}],"return":[{"type":"aTamCol  Array contendo os tamanhos das colunas baseados nos","description":""}],"since":"24/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"RetTamTex","author":"Marcos Taranta\r","description":"Retorna o tamanho em pixels de uma string. (Workaround para o GetTextWidth)","example":[],"history":[],"link":[],"param":[{"name":"cTexto   Texto a ser medido.","type":"","description":"","obrigatory":""}],"return":[{"type":"nTamanho Tamanho em pixels da string.","description":""}],"since":"24/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"PosQuebrVal","author":"Marcos Taranta\r","description":"Retorna a posição onde um valor deve ser quebrado","example":[],"history":[],"link":[],"param":[{"name":"cTexto Texto a ser medido.","type":"","description":"","obrigatory":""}],"return":[{"type":"nPos   Posição aonde o valor deve ser quebrado.","description":""}],"since":"27/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"executeRetorna","author":"Henrique Brugugnoli\r","description":"Executa o retorna de notas","example":[],"history":[],"link":[],"param":[{"name":"cID ID da nota que sera retornado","type":"","description":"","obrigatory":""}],"return":[{"type":"aRetorno   Array com os dados da nota","description":""}],"since":"17/01/2013\r","type":"function\r","version":"1.0 \r"}]},{"fileName":"/Rotinas PRW/F7VDANFRVALXML.prw","functionList":[{"functionName":"F7VDANFRVALXML","author":"Eduardo Riera\r","description":"Rotina de Impressão do DANFE - Formato Retrato","example":[],"history":[{"date":"29/01/2021","username":"Carlos Eduardo Niemeyer Rodrigues","description":"Melhorias para o Validador de XML"}],"link":[],"param":[],"return":[],"since":"16/11/2006\r","type":"function\r"},{"functionName":"RetTamCol","author":"Marcos Taranta\r","description":"Retorna um array do mesmo tamanho do array de entrada, contendo as\r<br>medidas dos maiores textos para cálculo de colunas.","example":[],"history":[],"link":[],"param":[{"name":"aCabec     Array contendo as strings de cabeçalho das colunas","type":"","description":"","obrigatory":""}],"return":[{"type":"aTamCol  Array contendo os tamanhos das colunas baseados nos","description":""}],"since":"24/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"RetTamTex","author":"Marcos Taranta\r","description":"Retorna o tamanho em pixels de uma string. (Workaround para o GetTextWidth)","example":[],"history":[],"link":[],"param":[{"name":"cTexto   Texto a ser medido.","type":"","description":"","obrigatory":""}],"return":[{"type":"nTamanho Tamanho em pixels da string.","description":""}],"since":"24/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"PosQuebrVal","author":"Marcos Taranta\r","description":"Retorna a posição onde um valor deve ser quebrado","example":[],"history":[],"link":[],"param":[{"name":"cTexto Texto a ser medido.","type":"","description":"","obrigatory":""}],"return":[{"type":"nPos   Posição aonde o valor deve ser quebrado.","description":""}],"since":"27/05/2011\r","type":"function\r","version":"1.0 \r"},{"functionName":"executeRetorna","author":"Henrique Brugugnoli\r","description":"Executa o retorna de notas","example":[],"history":[],"link":[],"param":[{"name":"cID ID da nota que sera retornado","type":"","description":"","obrigatory":""}],"return":[{"type":"aRetorno   Array com os dados da nota","description":""}],"since":"17/01/2013\r","type":"function\r","version":"1.0 \r"},{"functionName":"SimpDanfe","author":"Rafael Iaquinto\r","description":"Impressao do formulario DANFE grafico conforme laytout no formato \r<br>simplificado.","example":[],"history":[],"link":[],"param":[{"name":"oDanfe\t\tObjeto FWMSPrinter","type":"para desenho do documento.","description":"","obrigatory":""},{"name":"oNfe\t\tObjeto do XML da NF-e","type":"","description":"","obrigatory":""},{"name":"cCodAutSef\tCódigo de autorização da NF-e","type":"","description":"","obrigatory":""},{"name":"cModalidade\tModalidade de transmissão da NF-e","type":"","description":"","obrigatory":""},{"name":"oNfeDPEC\tObjeto do XML do DPEC.","type":"","description":"","obrigatory":""},{"name":"cCodAutDPEC\tCodigo de autorização do DPEC","type":"","description":"","obrigatory":""},{"name":"cDtHrRecCab\tHora de Recebimento da NF-e","type":"","description":"","obrigatory":""},{"name":"dDtReceb\tData de recebimento da NF-e","type":"","description":"","obrigatory":""},{"name":"aNota\t\tArray com informações do documento a ser impresso.","type":"","description":"","obrigatory":""}],"return":[{"type":".T.","description":""}],"since":"17.04.2013\r","type":"function\r","version":"10   \r"}]},{"fileName":"/Rotinas PRW/F7VXML01.prw","functionList":[{"functionName":"F7VXML01","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Executa o Cadastro de Campos a serem usados no Cadastro de Regras do Validador do XML\r<br>Usa a Classe Class7VValidadorXML para definir as propriedades do cadastro","example":[],"history":[],"link":[],"obs":"\tUsa a variável Pública oClass7VValidadorXML\r","param":[],"return":[{"type":"logical","description":"Retorna se foi executado com sucesso"}],"since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/Rotinas PRW/F7VXML02.prw","functionList":[{"functionName":"u","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Executa o Cadastro de Regras do Validador de XML\r<br>Usa a Classe Class7VValidadorXML para definir as propriedades do cadastro","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna se foi executado com sucesso"}],"since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/Rotinas PRW/F7VXML03.prw","functionList":[{"functionName":"F7VXML03","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Executa o Cadastro de Regras do Validador de XML\r<br>Usa a Classe Class7VValidadorXML para definir as propriedades do cadastro","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna se foi executado com sucesso"}],"since":"29/01/2021\r","type":"function\r"}]},{"fileName":"/WebServiceTOTVSIP/WSIPServicos.prw","functionList":[]},{"fileName":"/Classes/Class7VValidadorXML.tlpp","functionList":[{"functionName":"Class7VValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Classe para Validação do XML da Nota Fiscal de Entrada de Terceiros\r<br>Ao incluir/classificar a Nota Fiscal de Entrada no Protheus, irá ocorrer uma validação do XML da NF\r<br>para verificar se existem divergências entre a digitação e o valor da Nota Fiscal do Fornecedor\r<br>Operacao = I=Inclusão na Pré-Nota;C=Classificação;IC=Inclusão Direta da NF de Entrada","example":[],"history":[],"link":[],"obs":"\tPossui integração com o Gestor de XML da TOTVS IP com o Validador de XML da SEVEN Consultoria,\r<br>\tconsumindo o Webservice fornecido para obter o XML, entretanto, existem outras formas de obter a origem dos dados do XML\r<br>\tPode ser executada em 3 momentos:\r<br>\t- Inclusão da Pré-Nota\r<br>\t- Classificação do Documento de Entrada \r<br>\t- Inclusão da NF de Entrada\r<br>\tParâmetros Personalizados \t: 7V_VLDXML - Parâmetro que indica se o Validador XML está ativado ou não\r<br>\t\t\t\t\t\t\t\t: 7V_USRVLD - Login dos Usuários com autorização para Liberar - Padrão: Libera Administrador\r<br>\t\t\t\t\t\t\t\t: 7V_TESNXML - TES que não devem realizar a conferência/validação do XML\r<br>\t\t\t\t\t\t\t\t: 7V_ESPXML - Espécie que devem realizar a conferência/validação do XML\r<br>\t\t\t\t\t\t\t\t: 7V_URLARM - http://192.168.0.7:8002/integracao/\r<br>\t\t\t\t\t\t\t\t: 7V_TBCPXML (Opcional) - Padrão: ZSE\r<br>\t\t\t\t\t\t\t\t: 7V_TBRLXML (Opcional) - Padrão: ZSF\r<br>\t\t\t\t\t\t\t\t: 7V_TBLGXML (Opcional) - Padrão: ZSG\r<br>\t\t\t\t\t\t\t\t: 7V_NAVEG (Opcional) - Padrão: CHROME.EXE   \r<br>\t\t\t\t\t\t\t\t: 7V_MSVDXML (Opcional) - Padrão: T - Se mostra a mensagem quando validado\r<br>\t7V_SRCXML - Define o Tipo de Origem\t\t\t\t\t\t\t\t\r<br>\tXML_SOURCE_FILE\t\t\t\t\"1\"\r<br>\tXML_SOURCE_DATABASE\t\t\t\"2\"\r<br>\tXML_SOURCE_CUSTOM \t\t\t\"3\"\r<br>\tXML_SOURCE_IMP_XML_PROTHEUS\t\"4\"\r<br>\tXML_SOURCE_GESTOR_TOTVSIP\t\"5\"\r","param":[],"return":[],"see":"produtosSeven.u_EstornaRejeicaoNFValidadorXML()\r","since":"15/01/2021\r","type":"class\r","version":"V1.00-15/01/2021\r"},{"functionName":"newClass7VValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Inicializar os a Classe do Validador de XML","example":[],"history":[],"link":[],"param":[{"name":"cOperation","type":"character","description":"Operação sendo executada para validar o XML - I=Inclusão Pré-Nota;C=Classificação;IC=Inclusão de NF (Inclusão e Classificação ao Mesmo Tempo)","obrigatory":""},{"name":"cDocPE","type":"character","description":"Nº do Documento da NF sendo Validado","obrigatory":""},{"name":"cSeriePE","type":"character","description":"Série do Documento da NF sendo Validado","obrigatory":""},{"name":"cFornecePE","type":"character","description":"Código do Fornecedor do Documento da NF sendo validado","obrigatory":""},{"name":"cLojaPE","type":"character","description":"Loja do Fornecedor do Documento da NF sendo validado","obrigatory":""},{"name":"cTipoPE","type":"character","description":"Tipo do Documento da NF sendo validado","obrigatory":""}],"return":[],"since":"15/01/2021\r","type":"method\t\t\t\t\r"},{"functionName":"getTitle","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método que retorna o Título da Classe","example":[],"history":[],"link":[],"param":[],"return":[{"type":"character","description":"cTitle - Título da Classe"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"isLicensed","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método que retorna se o Produto está licenciado","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lLicensed - Produto Licenciado"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"checkInstallation","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método que Verifica se o Validador XML foi instalado e caso não esteja, executa o processo de instalação\r<br>Procura o arquivo \"7Vvalidadorxml.ins\"","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Indica se foi ou não Instalado"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"install","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Instalação do Acelerador de Validação do XML","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Retorna o Status da Instalação do Validador XML"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"execute","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Iniciar Carga dos Dados, executar a Pré-Validação e Executar a Validação do XML da NF em referência, executando o método\r<br>subExecute se pré-validado.","example":[],"history":[],"link":[],"param":[{"name":"lCompareData","type":"logical","description":"Executa a carga de Dados e executa as Validações do Validador XML (Opcional) - Padrão: .T.","obrigatory":""}],"return":[{"type":"logical","description":"Retorna o Status da compareDatação da Validação do XML"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"subExecute","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método que carrega as regras carrega de validação, carrega o XML, consultando o WebService do Gestor da SEVEN Consultoria e, por fim,\r<br>valida e compara os dados do XML com os dados da NF","example":[],"history":[],"link":[],"param":[{"name":"lCompareData","type":"logical","description":"Executa a carga de Dados e executa as Validações do Validador XML (Opcional) - Padrão: .T.","obrigatory":""}],"return":[{"type":"logical","description":"Retorna o Status da comparação da Validação do XML"}],"see":"execute()\r","since":"19/01/2021\r","type":"method\r","version":"P10/P11\r"},{"functionName":"loadData","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar os Dados da NF em Referência, verificando o momento da Validação (Classificação, Inclusão de Pré-Nota e Inclusão da NF)\r<br>Carrega os dados da NF para as variáveis aDadosNFCab, aDadosNF, aDadosNFItCab, aDadosNFIt\r<br>Carrega os Dados dos Cabeçalho da NF com base nos campos definidos na tabela de Campos do Validador XML\r<br>Avalia o Tipo da NF (Atributo cTypeXML), de acordo com a espécie da NF     \r<br>Gera os arquivos da consulta SQL executado na pasta \\sql\\ do Protheus_Data","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da Carga de Dados"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"PE7VDX03","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de Entrada na Avaliação do Código do Produto do Fornecedor amarrado ao Código do Produto para o Protheus\r<br>\t\t\t\t\t\t\tPermite fazer De-Para personalizado (Diferente do SA5) para comparar o Produto do Protheus com os Itens do XML da NF-e\r<br>\t\t\t\t\t\t\tO PE deve receber o código do Produto do Fornecedor","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"Objeto da Classe do Validador XML","obrigatory":""},{"name":"cFornece","type":"character","description":"Código do Fornecedor Identificado","obrigatory":""},{"name":"cLoja","type":"character","description":"Loja do Fornecedor Identificado","obrigatory":""},{"name":"cCodProduto","type":"character","description":"Código do Produto no Protheus (D1_COD)","obrigatory":""}],"return":[{"type":"character","description":"cCodProdFornecedor - Código do Produto para o Fornecedor"}],"since":"29/01/2021\r","type":"function\r"},{"functionName":"validateData","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Validar se irá executar a Validação do XML da Pré-Nota/Documento de Entrada, executando as seguintes validações:\r<br>01-Verifica se a Personalizaçao de Validação do XML do Documento de Entrada está Ativada\r<br>02-Verifica se o Validador XML está licenciado\r<br>03-Verifica se os dados foram carregados\r<br>04-Verifica se o Tipo da NF for diferente de Formulário de Terceiros (Formulário Próprio = Não)\r<br>05-Verifica se a Espécie da NF deve ou não ser validada\r<br>06-Verifica se o Cliente/Fornecedor deve ter a NF validada\r<br>07-Verifica a TES indica que deve ser validada a NF (Se houver um item com um TES que não é para validar então não valida a NF)","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da Pré-Validação"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"loadRules","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar as Regras Definidas no Protheus para Validar o XML do Documento de Entrada\r<br>carrega os dados da regras da tabela de regras do Validador XML\r<br>Grava os comandos da consulta SQL executada na pasta \\sql\\ no Protheus_Data","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da Carga das Regras de Validação do XML"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"loadXMLData","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar o XML da NF solicitada, podendo buscar o XML de:\r<br>- Base de Dados de XML (Parametrizável)\r<br>- Arquivo XML (Parametrizável)\r<br>- Gestor de XML TOTVS IP via WS\r<br>- Fonte Customizada\r<br>Caso não consiga encontrar o XML, gera Logs a serem apresentados na Interface da Divergência do XML","example":[],"history":[],"sample":"\tVariáveis Privates para uso externo:\r<br>\toValidadorXML (Para uso da Classe do Validador de XML)\r<br>\toValXML (Para uso da Classe do Validador de XML - Variável mais curta)\r<br>\toXML ( Para uso com CT-e)\r","link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da Carga do XML"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"loadXMLfromFile","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar o XML da NF solicitada, buscando os dados de arquivo XML em pasta parametrizável\r<br>Caso não consiga encontrar o XML, gera Logs a serem apresentados na Interface da Divergência do XML\r<br>Permitirá utilizar comandos ADVPL embarcados dentro dos parâmetros com #","example":[],"history":[],"link":[],"obs":"\tCriado a variável Private da Classe do Validador XML (oValidadorXML) para uso externo\r<br>\tPode ser usado o método getValue para buscar os dados da NF carregados pelo Validador em memória. Exemplo:\r<br>\toValidadorXML:getValue(\"F1_FILIAL\")\r<br>\toValidadorXML:getValue(\"F1_DOC\")\r<br>\toValidadorXML:getValue(\"F1_SERIE\")\r<br>\toValidadorXML:getValue(\"F1_FORNECE\")\r<br>\toValidadorXML:getValue(\"F1_LOJA\")\r<br>\toValidadorXML:getValue(\"F1_EMISSAO\")\r<br>\toValidadorXML:getValue(\"F1_CHVNFE\")\r<br>\tAllTrim(SM0->M0_CGC) - CNPJ da Empresa Ativa\r<br>\tPode ser usado inclusive uma função ADVPL que internamente trate os conteúdos ADVPL e retorne o nome final do Folder e do Arquivo XML\r","param":[],"return":[{"type":"logical","description":"Indica se o arquivo XML foi localizado e carregado"}],"see":"7V_ARQXML (C) - Nome do Arquivo XML\r","since":"19/01/2021\r","type":"method\r"},{"functionName":"loadXMLData","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar o XML da NF solicitada, buscando os dados do Banco de Dados\r<br>em tabela parametrizada, usando também filtros parametrizáveis\r<br>Caso não consiga encontrar o XML, gera Logs a serem apresentados na Interface da Divergência do XML","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Indica se o arquivo XML foi localizado e carregado"}],"see":"https://tdn.totvs.com/pages/viewpage.action?pageId=234609733\r","since":"19/01/2021\r","type":"method\r"},{"functionName":"loadXMLfromCustomOrigin","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar o XML da NF solicitada, buscando o arquivo XML de fonte personalizada, usando\r<br>ponto de entrada ADVPl (prw) - PE7VDX05\r<br>Se o PE não existir será retornado um erro para o Validador XML informando que o PE não existe\r<br>Caso não consiga encontrar o XML, gera Logs a serem apresentados na Interface da Divergência do XML","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Indica se o arquivo XML foi localizado e carregado"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"PE7VDX05","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de Entrada na Carga de Dados do XML para buscar o XML de outras origens além do Gestor de XML","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"Objeto da Classe do Validador XML","obrigatory":""},{"name":"aDadosXMLCab","type":"array","description":"array no Formato aHeader com os Campos do XML a serem carregados","obrigatory":""}],"return":[{"type":"array","description":"aRet  Vetor contendo os seguintes Dados: {lRet, cXML, cLog}, onde cLog é o motivo do Retorno lRet = .F."}],"since":"29/01/2021\r","type":"function\r"},{"functionName":"loadXMLfromGestorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Carregar o XML da NF solicitada, buscando os dados do Banco de Dados do WS do Produto Gestor de XML da TOTVS IP\r<br>Método para Consumir o WebService (ListarXMLProtheus e Exportar) do Gestor de XML da TOTVS/IP e retornar o XML da NF solicitada\r<br>Consome o WebService definido no Parâmetro 7V_URLARM (Exemplo: http://127.0.0.1:8002/integracao/)\r<br>Regra para Consumir e retornar dados do WebService:\r<br>-Define a Data de Recebimento De, sendo DataBase do Sistema - 300 dias\r<br>-Define a Data de Recebimento Até, sendo DataBase do Sistema + 300 dias \r<br>-Define a Data de Emissão De/Até, sendo a Data de Emissão do Documento de Entrada\r<br>-Define os outros parâmetros de busca, sendo de Branco a Z, a fim de trazer todas as NFs do Período relacionado e, posteriormente, validar se a NF\r<br>em questão (Doc/Série) existe na Base de Dados do Gestor do XML\r<br>Ordem de Busca para Identificar a Nota Fiscal em referência na Base de Dados de XML de NFs (Gestor do XML):\r<br>1) Filtra Período de Recebimento (Faixa De-Até) - NFs Recebidas dentro de um Intervalo (Pelo WebService)\r<br>2) Filtra Somente NFs cuja Emissão seja igual a digitada pelo Usuário (Pelo WebService)\r<br>3) Filtra pela Série e Número da NF (Pelo Protheus) - Transformar em Dados Numericos antes de Pesquisar\r<br>4) Avalia o CNPJ do Destinatário - Empresa no Protheus (Pelo Protheus) - Parte das Regras (Regra Básica)\r<br>5) Avalia o CNPJ do Emitente - Fornecedor/Cliente no Protheus (Pelo Protheus) - Parte das Regras (Regra Básica)\r<br>Caso não consiga encontrar o XML na Base de Dados do Gestor, gera Logs a serem apresentados na Interface da Divergência do XML","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da Carga do XML"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"PE7VDX04","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de Entrada na Carga de Dados do XML para buscar o XML de outras origens além do Gestor de XML","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"Objeto da Classe do Validador XML","obrigatory":""},{"name":"aDadosXMLCab","type":"array","description":"array no Formato aHeader com os Campos do XML a serem carregados","obrigatory":""}],"return":[{"type":"array","description":"aRet - Vetor contendo os seguintes Dados: {lRet, cXML, cLog}, onde cLog é o motivo do Retorno lRet = .F."}],"since":"29/01/2021\r","type":"function\r"},{"functionName":"compareData","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para comparar os Dados da NF com o XML e avaliar as divergências conformas as regras cadastradas na Tabela de Regras do Validador\r<br>Além de validar, define a ação a ser tomada com relação a regra (Liberar, Liberar com Senha, Liberar com Alçada ou Bloquear)","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status da comparação do XML com os dados da NF"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"PE7VDX01","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de Entrada na Comparação de Dados do Cabeçalho, permitindo que sejam alterados os dados de Variáveis Private cFieldProtheus,cFieldXML,uContentProtheus, uContentXML, cOper,\r<br>\tbem como variáveis de avaliação das regras.\r<br>\tVariáveis Private Disponíveis: cSeq,cDesc,cDescCompl,cFieldProtheus,cFieldXML,cOper,cContext,cAction,cDescAction,cSystem,cEscope,uContentXML,uContentProtheus,nActualRecord,cItem","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"objeto da classe do validador de XML","obrigatory":""},{"name":"aRules","type":"array","description":"array com as regras carregadas sendo executadas","obrigatory":""},{"name":"nRule","type":"numeric","description":"Nº da Regra sendo avaliada","obrigatory":""},{"name":"aDadosNFCab","type":"array","description":"array no Formato aHeader com os Campos da NF de Entrada do Protheus","obrigatory":""},{"name":"aDadosNF","type":"array","description":"array no Formato aCols com os Dados da NF de Entrada do Protheus (Um dos campos contém o Array dos Itens Vinculados)","obrigatory":""},{"name":"aDadosXMLCab","type":"array","description":"array no Formato aHeader com os Campos do XML","obrigatory":""},{"name":"aDadosXML","type":"array","description":"array no Formato aCols dos Dados carregados do XML (Um dos campos contém o Array dos Itens Vinculados)","obrigatory":""},{"name":"nXMLRecord","type":"numeric","description":"Nº do Record de XML posicionado","obrigatory":""}],"return":[],"since":"19/01/2021\r","type":"function\r"},{"functionName":"PE7VDX02","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Ponto de Entrada na Comparação de Dados dos Itens, permitindo que sejam alterados os dados de Variáveis Private cFieldProtheus,cFieldXML, uContentProtheus, uContentXML, cOper,\r<br>\t\t\t\tbem como variáveis de avaliação das regras.\r<br>\t\t\t\tVariáveis Private Disponíveis: cSeq,cDesc,cDescCompl,cFieldProtheus,cFieldXML,cOper,cContext,cAction,cDescAction,cSystem,cEscope,uContentXML,uContentProtheus,nActualRecord,cItem","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"Objeto da Classe do Validador de XML","obrigatory":""},{"name":"aRules","type":"array","description":"array com as regras carregadas sendo executadas","obrigatory":""},{"name":"nRule","type":"numeric","description":"Nº da Regra sendo avaliada","obrigatory":""},{"name":"aDadosNFCab","type":"array","description":"array no Formato aHeader com os Campos da NF de Entrada do Protheus","obrigatory":""},{"name":"aDadosNF","type":"array","description":"array no Formato aCols com os Dados da NF de Entrada do Protheus (Um dos campos contém o Array dos Itens Vinculados)","obrigatory":""},{"name":"aDadosNFItCab","type":"array","description":"array no Formato aHeader com os Campos dos Dados dos Itens da NF de Entrada do Protheus","obrigatory":""},{"name":"aDadosXMLCab","type":"array","description":"array no Formato aHeader com os Campos do XML","obrigatory":""},{"name":"aDadosXML","type":"array","description":"array no Formato aCols dos Dados carregados do XML (Um dos campos contém o Array dos Itens Vinculados)","obrigatory":""},{"name":"nXMLRecord","type":"numeric","description":"Nº do Record de XML posicionado","obrigatory":""},{"name":"nItemRecord","type":"numeric","description":"Nº do Record dos Itens Posicionado","obrigatory":""},{"name":"aDadosXMLItCab","type":"array","description":"array no Formato aHeader com os Campos dos Dados dos Itens do XML","obrigatory":""},{"name":"nPosXMLProd","type":"numeric","description":"Posição do Campo do Código de Produto no XML","obrigatory":""}],"return":[],"since":"19/01/2021\r","type":"function\r"},{"functionName":"showDivergences","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para apresentar as divergências entre a NF Digitada e o XML do Fornecedor\r<br>Pode ser apresentada na Carga do XML - Avaliações Iniciais\r<br>ou pode ser apresentada após a comparação dos dados da NF com os Dados do XML\r<br>Define os Logins dos Usuários com autorização para Liberar (7V_USRVLD) - Padrão: Libera Administrador","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna o Status se Bloqueia ou não o Processo (Falso=Bloqueia)"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"showDANFE","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Apresentação da DANFE - Somente para NFe - Imprime a DANFE, apresentando a Tela de Spool (FwMsPrinter),\r<br>disponível no formato paisagem ou retrato","example":[],"history":[],"link":[],"param":[],"return":[],"since":"19/01/2021\r","type":"method\r"},{"functionName":"printDANFE","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Impressão da DANFE de Forma Automática Baseado na Função SpedDanfe()","example":[],"history":[],"link":[],"param":[{"name":"cSerie","type":"character","description":"Série da NF","obrigatory":""},{"name":"cDoc","type":"character","description":"Nº do Documento da NF","obrigatory":""},{"name":"cCliFor","type":"character","description":"Código do Cliente ou Fornecedor para Impressão da DANFE","obrigatory":""},{"name":"cLoja","type":"character","description":"Loja do Cliente ou Fornecedor para Impressão da DANFE","obrigatory":""},{"name":"cTipo","type":"character","description":"Tipo de NF, sendo S=Saúda e E=Entrada","obrigatory":""},{"name":"cPrinter","type":"character","description":"Impressora Padrão para Impressão - Se não definido considera a Impressora em 7V_PRTNFE","obrigatory":""},{"name":"cFilePrint","type":"character","description":"Nome do Arquivo PDF da Impressão da DANFE","obrigatory":""},{"name":"cDirPDF","type":"character","description":"Nome da Pasta a gerar o Arquivo PDF da Impressão da DANFE","obrigatory":""},{"name":"cOrientacao","type":"character","description":"Orientação do Papel - RETRATO ou PAISAGEM","obrigatory":""},{"name":"lServer","type":"logical","description":"Se é impresso no Server - Na Impressão Automática Precisa ser no Servidor (Impressão Local em Teste)","obrigatory":""},{"name":"lAtivaSetup","type":"logical","description":"Se deve ativar a Tela de Setup do FwMsPrinter na Impressão do DANFE","obrigatory":""},{"name":"lSpool","type":"logical","description":"Se ativa a impressão via Spool - Na Impressão Automática pode ser Spool ou PDF","obrigatory":""}],"return":[{"type":"character","description":"Retorna o nome do Arquivo gerado na Impressão da DANFE"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"saveDivergences","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Salvar o Log das Divergências na Tabela de Logs do Validador XML","example":[],"history":[],"link":[],"param":[],"return":[],"since":"19/01/2021\r","type":"method\r"},{"functionName":"saveXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Salvar o XML carregado no Protheus (Opcional) \r<br>Salva o XML somente se existir o campo F1_7VXML\r<br>Considera a NF posicionada","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Indica se foi salvo com sucesso"}],"see":"produtosSeven.u_PEValidadorXML()\r","since":"19/01/2021\r","type":"method\r"},{"functionName":"saveChaveDeAcesso","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Salvar a Chave da NFe carregado no Protheus (Opcional) - Usar no PE MT140SAI\r<br>Força o posicionamento da Tabela SF1","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Indica se foi salvo com sucesso"}],"see":"produtosSeven.u_PEValidadorXML()\r","since":"19/01/2021\r","type":"method\r"},{"functionName":"saveNFDeFrete","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Salvar os Dados da NF de Frete nas NFs de Entrada ou Saída vinculadas (Somente para CTe) - Usar no PE MT140SAI\r<br>Salva somente se existir Campos Personizados no Cabeçalhos da NFs de Entrada e/ou Saída\r<br>Se Tomador igual a \"0\" (Remetente) grava a NF do Frete nos Campos Personalizados (F2_7VNFENT,F2_7VSRENT,F2_7VCDENT,F2_7VLJENT,F2_7VDTFXM) das NFs Vinculadas\r<br>Se Tomador igual a \"3\" (Destinatário) grava a NF do Frete nos Campos Personalizados (F1_7VNFENT,F1_7VSRENT,F1_7VCDENT,F1_7VLJENT,F1_7VDTFXM) das NFs Vinculadas\r<br>Somente para CTe\r<br>Força o posicionamento das tabelas SF1/SF2","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Indica se foi salvo com sucesso"}],"see":"produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"method\r"},{"functionName":"saveBloqNF","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Salvar a NF como Bloqueada no PE MT103FIM","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Indica se foi salvo com sucesso"}],"see":"produtosSeven.u_PEValidadorXML()\r","since":"13/02/2021\r","type":"method\r"},{"functionName":"releaseWithPassword","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Abrir Interface de Liberação de Processos, informando Login e Senha de Usuário do Protheus","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Verifica se o Login e senha são válidos, retornando o status da Liberação"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"releaseWithBloqDoc","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Liberar o documento fiscal por Alçada, gravará a NF com o Status de Bloqueada\r<br>e gravará os dados na Tabela SCR para posterior utilização","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"lRet - Indica se foi liberado o documento por alçada"}],"see":"produtosSeven.u_PEValidadorXML()\r","since":"29/01/2021\r","type":"method\r"},{"functionName":"releaseWithBloqDoc","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Verifica o Status das Alçadas da NF\tusado no método showDivergences\r<br>Regras: \r<br>. 01=Aguardando nivel anterior;02=Pendente;03=Liberado;04=Bloqueado;05=Liberado outro aprov.;06=Rejeitado;07=Rej/Bloq outro aprov.\r<br>. Se todos liberados = libera automaticamente (03/05)\r<br>. Se um dos rejeitados/bloqueados = Avisa usuário para excluir a NF (06/07/04)","example":[],"history":[],"link":[],"param":[],"return":[],"see":"showDivergences()\r","since":"16/02/2021\r","type":"method\r"},{"functionName":"showXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Apresentar o XML da NF (Em Tela ou em Navegador), visualizar Log das Divergências e\r<br>Impressão da DANFE","example":[],"history":[],"link":[],"param":[],"return":[],"since":"19/01/2021\r","type":"method\r"},{"functionName":"exportXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Exporta o XML para Consulta no Navegador da Internet","example":[],"history":[],"link":[],"param":[],"return":[],"since":"19/01/2021\r","type":"method\r"},{"functionName":"selectProtheusExpression","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Seleção de Expressão/Campos do Protheus - Usado no Cadastro de Regras, na Validação do Campo Protheus","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna sempre Verdadeiro"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"selectXMLExpression","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Seleção de Expressão/Campos do XML - Usado no Cadastro de Regras, na Validação do Campo XML","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna sempre Verdadeiro"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"selectOperator","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Seleção do Operador de Avaliação - Usado no Cadastro de Regras, na validação do campo de operação","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Retorna sempre Verdadeiro"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"expCpoRul","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Retornar a Expressão do Campo da Regra","example":[],"history":[],"link":[],"param":[{"name":"cField","type":"character","description":"Campo a ser Pesquisado na tabela de campos do Validador XML (Nome do Campo ou Campo do XML)","obrigatory":""},{"name":"cTipo","type":"character","description":"Tipo de Campo a ser Pesquisado na tabela de campos do Validador XML (P=Protheus;N=NFE;C=CTE)","obrigatory":""},{"name":"cEscope","type":"character","description":"Escopo do Campo ser Pesquisado na tabela de campos do Validador XML (C=Cabeçalho;I=Itens)","obrigatory":""}],"return":[{"type":"character","description":"Retorna a Expressão do Campo da Regra (Se houver)"}],"since":"19/01/2021 \r","type":"method\r"},{"functionName":"getValue","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Retornar o Conteúdo de um campo dos dados carregados em memória do XML e do Protheus","example":[],"history":[],"link":[],"param":[{"name":"cField","type":"character","description":"Campo a ser Pesquisado na tabela de campos do Validador XML (Nome do Campo ou Campo do XML)","obrigatory":""},{"name":"nRecord","type":"character","description":"Tipo de Campo a ser Pesquisado na tabela de campos do Validador XML (P=Protheus;N=NFE;C=CTE)","obrigatory":""},{"name":"[nType]","type":"character","description":"Tipo de Origem para pesquisa do Campo. Padrão: TIPO_NF - Opções: 1=TIPO_NF,2=TIPO_NF_ITENS,3=TIPO_XML,4=TIPO_XML_ITENS,5=TIPO_XML_VALIDATOR,6=TIPO_XML_RULES","obrigatory":""},{"name":"[aData]","type":"array","description":"array de dados opcional - Para otimizações se necessário","obrigatory":""},{"name":"[nFieldPos]","type":"numeric","description":"posição do campo - Para uso por referência se necessário","obrigatory":""}],"return":[{"type":"variadic","description":"uContent Conteúdo do Campo"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"getTagValue","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Retornar o Conteúdo de uma Tag do XML carregado\r<br>Tratando conteúdo ParserXML e tXMLManager(xPath)","example":[],"history":[],"link":[],"obs":"\tPara NF-e e CT-e usa a Variável oXML quando usado o XMLParser()\r<br>\tAo usar a Classe TXmlManager irá usar o método getTagValue() da Classe Class7VNFeLib/Class7VCTeLib \r<br>\tcarregado internamente na classe Class7VValidadorXML\r","param":[{"name":"cTag","type":"character","description":"Tag XML no padrão XMLParser() ou TXmlManager()","obrigatory":""},{"name":"lAddTextInTag","type":"logical","description":"Indica se adiciona na tag o complemento TEXT. Padrão: .T. (Quando usado a função XMLParser)","obrigatory":""},{"name":"cType","type":"character","description":"Tipo de Tag que será analisado, podendo ser: NFE ou DPEC","obrigatory":""},{"name":"lUseTXMLManager","type":"logical","description":"Indica se está usando a class TXmlManager - Tags XML usando xPath","obrigatory":""}],"return":[{"type":"variadic","description":"uContent Conteúdo da Tag XML"}],"since":"06/02/2021\r","todo":"Tratar getTagValue com xPath - Atualmente funcionando apenas no formato com XMLParser\r","type":"method\r"},{"functionName":"setValue","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para Atualizar o Conteúdo de um campo dos dados carregados em memória do XML e do Protheus","example":[],"history":[],"link":[],"param":[{"name":"cField","type":"character","description":"Campo a ser Pesquisado na tabela de campos do Validador XML (Nome do Campo ou Campo do XML)","obrigatory":""},{"name":"uContent","type":"variadic","description":"Conteúdo do campo a ser gravado","obrigatory":""},{"name":"nRecord","type":"character","description":"Tipo de Campo a ser Pesquisado na tabela de campos do Validador XML (P=Protheus;N=NFE;C=CTE)","obrigatory":""},{"name":"[nType]","type":"character","description":"Tipo de Origem para pesquisa do Campo. Padrão: TIPO_NF - Opções: 1=TIPO_NF,2=TIPO_NF_ITENS,3=TIPO_XML,4=TIPO_XML_ITENS,5=TIPO_XML_VALIDATOR,6=TIPO_XML_RULES","obrigatory":""},{"name":"[aData]","type":"array","description":"array de dados opcional - Para otimizações se necessário","obrigatory":""},{"name":"[nFieldPos]","type":"numeric","description":"posição do campo - Para uso por referência se necessário","obrigatory":""}],"return":[{"type":"logical","description":"lRet - Indica se o conteúdo foi atualizado"}],"since":"29/01/2021\r","type":"method\r"},{"functionName":"existField","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Método para verificar se existe o campo informado para o tipo de origem informada","example":[],"history":[],"link":[],"param":[{"name":"cField","type":"character","description":"Campo a ser Pesquisado na tabela de campos do Validador XML (Nome do Campo ou Campo do XML)","obrigatory":""},{"name":"[nType]","type":"character","description":"Tipo de Origem para pesquisa do Campo. Padrão: TIPO_NF - Opções: 1=TIPO_NF,2=TIPO_NF_ITENS,3=TIPO_XML,4=TIPO_XML_ITENS,5=TIPO_XML_VALIDATOR,6=TIPO_XML_RULES","obrigatory":""},{"name":"[nPosField]","type":"numeric","description":"posição do campo - Usar por referência","obrigatory":""}],"return":[{"type":"logical","description":"Indica se o campo existe para o tipo de origem de dados informada"}],"since":"19/01/2021\r","type":"method\r"},{"functionName":"validadorXML","author":"Carlos Eduardo Niemeyer Rodrigues - FSW - TOTVS RP\r","description":"Rotina de Validação do XML da Nota Fiscal de Entrada de Terceiros na Inclusão da Pré-Nota, Classificação da NF ou Inclusão da NF\r<br>Ao incluir/classificar a Nota Fiscal de Entrada no Protheus, irá ocorrer uma validação do XML da NF\r<br>para verificar se existem divergências entre a digitação e os valores do XML da Nota Fiscal do Fornecedor","example":[],"history":[],"link":[],"obs":"\tDisponibilizo o Objeto oClass7VValidadorXML (Público) para acessos aos atributos e métodos da Classe\r","param":[{"name":"cOperacao","type":"character","description":"Operação sendo executada para validar o XML - I=Inclusão Pré-Nota;C=Classificação;IC=Inclusão de NF (Inclusão e Classificação ao Mesmo Tempo)","obrigatory":""},{"name":"cDocPE","type":"character","description":"Nº do Documento da NF sendo Validado","obrigatory":""},{"name":"cSeriePE","type":"character","description":"Série do Documento da NF sendo Validado","obrigatory":""},{"name":"cFornecePE","type":"character","description":"Código do Fornecedor do Documento da NF sendo validado","obrigatory":""},{"name":"cLojaPE","type":"character","description":"Loja do Fornecedor do Documento da NF sendo validado","obrigatory":""},{"name":"cTipoPE","type":"character","description":"Tipo do Documento da NF sendo validado","obrigatory":""}],"return":[{"type":"logical","description":"Retorna o Status da Validação do XML"}],"since":"28/01/2021\r","type":"function\t\t\t\t\r"},{"functionName":"PE7VDX00","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"PE para Modificar Atributos da Classe Antes de Executá-la","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"Objeto da Classe do Validador de XML","obrigatory":""}],"return":[{"type":"object","description":"Objeto da Classe do Validador de XML modificado - oClass7VValidadorXML"}],"since":"28/01/2021\r","type":"function\r"},{"functionName":"RejeitaNFValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Rejeita Documentos de Nf na Rotina MATA094 via Central de Processos\r<br>Status possíveis:\r<br>01=Aguardando nivel anterior;02=Pendente;03=Liberado;04=Bloqueado;05=Liberado outro aprov.;06=Rejeitado;07=Rej/Bloq outro aprov.","example":[],"history":[],"link":[],"param":[],"return":[],"since":"16/02/2021\r","type":"function\r"},{"functionName":"EstornaRejeicaoNFValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Estorna a Rejeição de Documentos de Nf na Rotina MATA094 via Central de Processos\r<br>Status possíveis:\r<br>01=Aguardando nivel anterior;02=Pendente;03=Liberado;04=Bloqueado;05=Liberado outro aprov.;06=Rejeitado;07=Rej/Bloq outro aprov.","example":[],"history":[],"link":[],"param":[],"return":[],"since":"16/02/2021\r","type":"function\r"}]},{"fileName":"/Rotinas TLPP/InstallValidadorXML.tlpp","functionList":[{"functionName":"InstallValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Rotina para Instalação do Validador XML\r<br>1 - Cria as Tabelas (Padrão: ZSE, ZSF e ZSG) - Tabelas, Índices, Agrupamentos, Relacionamentos, Campos\r<br>2 - Cria Parâmetros Personalizados\r<br>3 - Cria Tabela Genérica\r<br>4 - Grava Arquivo Flag de Instalação","example":[],"history":[],"link":[],"param":[{"name":"oClass7VValidadorXML","type":"object","description":"objeto da Classe ClassValXML","obrigatory":""}],"return":[{"type":"logical","description":"Retorna o Status da Validação do XML"}],"since":"08/02/2021\r","todo":"Em Futuras versões usar componente de instalação da LibSeven\r","type":"function\r"}]},{"fileName":"/Rotinas TLPP/PEValidadorXML.tlpp","functionList":[{"functionName":"PEValidadorXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Rotina para executar funcionalidades do Validador de XML de acordo com o contexto de cada PE chamado\r<br>- Valida XML\r<br>- Salva a Chave de Acessos da NF-e\r<br>- Grava Vínculos das NFs de Frete\r<br>- Adiciona Itens no Menu aRotina","example":[],"history":[],"link":[],"param":[],"return":[],"see":"Class7VValidadorXML\r","since":"28/01/2021\r","type":"function\r"},{"functionName":"validaXML","author":"Carlos Eduardo Niemeyer Rodrigues\r","description":"Executa a Validação do XML da NF posicionada já gravada, avaliando as tabelas SF1/SD1 com o XML de Origem","example":[],"history":[],"link":[],"param":[],"return":[{"type":"logical","description":"Indica se a validação do XML ocorreu com sucesso"}],"see":"produtosSeven.u_validadorXML\r","since":"28/01/2021\r","type":"function\r"}]}]}
		